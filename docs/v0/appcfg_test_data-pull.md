## appcfg test data-pull

Test an individual or all data pull configurations

### Synopsis

Testing data pull configuration can be somewhat more involved than other app
platform configuration due the additional templates needed as well as possible
dependencies between data pull configurations.

Please make sure to also read the general "test" help documentation (`appcfg test -h`).

The request_url.gtpl and request_body.gtpl templates have access to the following
template data attributes:

- correlationId
- integration
- customer (the associated Gladly customer profile for which to pull the data)
- externalData

The "externalData" attribute is relevant for testing when a given data pull
configuration depends on the output of another. I.e. the "config.json" file
for the data pull being tested has a value specified for the "dependsOnDataTypes"
attribute. Templates for such a configuration have access to the data that they
depend on via the ".externalData.{depends on data type name}" attribute.

e.g. if a "product" data pull depends on an "order" data pull then the "product"
templates would have access to the "order" via an "externalData" attribute
that looks something like the following:

```
{
  "order": [
    {
      "id": "order1",
      ...
    }
  ]
}
```

Note for consistency, external data is always exposed as an array of objects.

A request_url.gtpl template file for retrieving products associated with orders
would look something like the following:

```
{{range .externalData.order}}
https://oms.com/products?orderId={{.id}}
{{end}}
```

When testing templates that depend on other data pulls, you will need to add
relevant test data to the "_test_/data/externalData.json" file.

As always, take a look at the test files generated as part of the data pull
configuration to get a sense of which template data attributes are available
as well as their structure. Template data attributes are defined in JSON files
named after the corresponding attribute with a ".json" extension and can be
found in the "_test_/data" folder.

The response_transformation.gtpl template has access to the following template
data attributes:

- correlationId
- integration
- customer (the associated Gladly customer profile for which to pull the data)
- externalData
- request (HTTP request)
- response (HTTP response)
- rawData (HTTP response data to be transformed in to the data type for this config)

The external_id.gtpl, external_parent_id.gtpl and external_updated_at.gtpl templates
act upon the data produced by the response_transformation.gtpl template. Read
the help documentation for the "add data-pull" command in order to get a better
understanding of these templates (`appcfg add data-pull -h`). Test data for these
templates is specified via the "externalData.json" file. Add an attribute named after
the data type specified in the "config.json" file for this data pull. Remember that
the values associated with "externalData" attributes are always arrays.

e.g. an "externalData.json" file for an "order" data type data pull

```
{
  "order": [
    {
      "id": "order1",
      "customerId": "customer1",
      "updatedAt": "2021-12-14T18:21:34Z",
      ...
    }
  ]
}
```

The templates are applied to the individual objects in the array so a template for
extracting the external ID for an "order" would be `{{.id}}`.


```
appcfg test data-pull [ data pull name ] [flags]
```

### Options

```
  -d, --data-set string   name of the data set to use for the test; data sets are located in sub folders of {data pull name}/_test_/data
  -h, --help              help for data-pull
  -t, --target string     target of the test; one of all, body, externalid, externalparentid, externalupdatedat, transformation, url (default "all")
```

### Options inherited from parent commands

```
  -o, --output string   where to output test results; one of: all, console, file, none; file output can be found in "_test_/output/[timestamp]" (default "console")
  -r, --root string     root folder for the app configuration; alternatively set the
                        GLADLY_APP_CFG_ROOT environment variable
```

### SEE ALSO

* [appcfg test](appcfg_test.md)	 - Test various individual configurations or all configurations

###### Auto generated by spf13/cobra on 29-May-2024
